estN.para4 <-
function(z,nhat){
		z0001=z[1];	z0010=z[2]; z0011=z[3]; z0100=z[4]; z0101=z[5];
		z0110=z[6]; z0111=z[7]; z1000=z[8]; z1001=z[9]; z1010=z[10];
		z1011=z[11]; z1100=z[12]; z1101=z[13]; z1110=z[14]; z1111=z[15]
		M=z0001+z0010+z0011+z0100+z0101+z0110+z0111+z1000+z1001+z1010+z1100+z1011+z1110+z1101+z1111
		if(nhat<=M){
			para=cbind(u1=0,u2=0,u3=0,u4=0,r12=0,r13=0,r14=0,r23=0,r24=0,r34=0) 
			colnames(para)=c("u1","u2","u3","u4","r12","r13","r14","r23","r24","r34")
			para
		}
		else{
			n1=z1000+z1001+z1010+z1100+z1011+z1110+z1101+z1111
			n2=z0100+z0101+z0110+z0111+z1100+z1110+z1101+z1111
			n3=z0010+z0011+z0110+z0111+z1010+z1011+z1110+z1111
			n4=z0001+z0011+z0101+z0111+z1001+z1011+z1101+z1111		
			
			u1=n1/nhat
			u2=n2/nhat
			u3=n3/nhat
			u4=n4/nhat

			r12=nhat*(z1100+z1101+z1110+z1111)/(n1*n2)-1                                          
			r13=nhat*(z1010+z1011+z1110+z1111)/(n1*n3)-1
			r14=nhat*(z1001+z1011+z1101+z1111)/(n1*n4)-1
			r23=nhat*(z0110+z0111+z1110+z1111)/(n2*n3)-1
			r24=nhat*(z0101+z0111+z1101+z1111)/(n2*n4)-1
			r34=nhat*(z0011+z0111+z1011+z1111)/(n3*n4)-1
			para=cbind(u1,u2,u3,u4,r12,r13,r14,r23,r24,r34)
			colnames(para)=c("u1","u2","u3","u4","r12","r13","r14","r23","r24","r34")
			para
		}
	}

