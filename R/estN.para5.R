estN.para5 <-
function(z,nhat){
		z00001=z[1]; z00010=z[2]; z00011=z[3]; z00100=z[4];
		z00101=z[5]; z00110=z[6]; z00111=z[7]; z01000=z[8]; 
		z01001=z[9]; z01010=z[10]; z01011=z[11]; z01100=z[12];
		z01101=z[13]; z01110=z[14]; z01111=z[15]; z10000=z[16]; 
		z10001=z[17]; z10010=z[18]; z10011=z[19]; z10100=z[20];
		z10101=z[21]; z10110=z[22]; z10111=z[23]; z11000=z[24];
		z11001=z[25]; z11010=z[26]; z11011=z[27]; z11100=z[28];
		z11101=z[29]; z11110=z[30]; z11111=z[31]
		M=sum(z)
		if(nhat<=M){
			para=cbind(u1=0,u2=0,u3=0,u4=0,u5=0,r12=0,r13=0,r14=0,r15=0,r23=0,r24=0,r25=0,r34=0,r35=0,r45=0)  
			colnames(para)=c("u1","u2","u3","u4","u5","r12","r13","r14","r15","r23","r24","r25","r34","r35","r45")
			para
		}
		else{
			n1=z10000+z10001+z10010+z10011+z10100+z10101+z10110+z10111+z11000+z11001+z11010+z11011+z11100+z11101+z11110+z11111
			n2=z01000+z01001+z01010+z01011+z01100+z01101+z01110+z01111+z11000+z11001+z11010+z11011+z11100+z11101+z11110+z11111
			n3=z00100+z00101+z00110+z00111+z01100+z01101+z01110+z01111+z10100+z10101+z10110+z10111+z11100+z11101+z11110+z11111
			n4=z00010+z00011+z00110+z00111+z01010+z01011+z01110+z01111+z10010+z10011+z10110+z10111+z11010+z11011+z11110+z11111
			n5=z00001+z00011+z00101+z00111+z01001+z01011+z01101+z01111+z10001+z10011+z10101+z10111+z11001+z11011+z11101+z11111
			
			u1=n1/nhat
			u2=n2/nhat
			u3=n3/nhat
			u4=n4/nhat
			u5=n5/nhat
			
			r12=nhat*(z11000+z11001+z11010+z11011+z11100+z11101+z11110+z11111)/(n1*n2)-1
			r13=nhat*(z10100+z10101+z10110+z10111+z11100+z11101+z11110+z11111)/(n1*n3)-1
			r14=nhat*(z10010+z10011+z10110+z10111+z11011+z11010+z11110+z11111)/(n1*n4)-1
			r15=nhat*(z10001+z10011+z10101+z10111+z11001+z11011+z11101+z11111)/(n1*n5)-1
			r23=nhat*(z01100+z01101+z01110+z01111+z11100+z11101+z11110+z11111)/(n2*n3)-1
			r24=nhat*(z01010+z01011+z01110+z01111+z11010+z11011+z11110+z11111)/(n2*n4)-1
			r25=nhat*(z01001+z01011+z01101+z01111+z11001+z11011+z11101+z11111)/(n2*n5)-1
			r34=nhat*(z00110+z00111+z01110+z01111+z10110+z10111+z11110+z11111)/(n3*n4)-1
			r35=nhat*(z00101+z00111+z01101+z01111+z10101+z10111+z11101+z11111)/(n3*n5)-1
			r45=nhat*(z00011+z00111+z01011+z01111+z10011+z10111+z11011+z11111)/(n4*n5)-1
			para=cbind(u1,u2,u3,u4,u5,r12,r13,r14,r15,r23,r24,r25,r34,r35,r45)
			colnames(para)=c("u1","u2","u3","u4","u5","r12","r13","r14","r15","r23","r24","r25","r34","r35","r45")
			para
		}
	}

